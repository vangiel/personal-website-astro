---
import FormattedDate from "@/components/FormattedDate.astro";
import Layout from "@/layouts/Layout.astro";
import type { GetStaticPaths } from "astro";
import { Image } from "astro:assets";
import { getCollection } from "astro:content";

export const getStaticPaths = (async () => {
	const posts = await getCollection("blog");
	return posts.map((post) => ({
		params: {
			slug: post.slug,
		},
		props: post,
	}));
}) satisfies GetStaticPaths;

const {
	body,
	data: { heroImage, pubDate, tags, title },
} = Astro.props;
---

<!-- TODO: Convert this into a compoent and format the data of the body -->
<Layout title={title}>
	<header class="main-header">
		<button class="back-button">
			<a href="/blog">
				<svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" height="20" width="20"
					><path d="m313-440 224 224-57 56-320-320 320-320 57 56-224 224h487v80H313Z" fill="#BFC7D2"
					></path></svg
				>
				Back to blog
			</a>
		</button>
	</header>
	<main>
		<article transition:name={title}>
			<header class="article-header">
				<Image class="image" src={heroImage} alt="placeholder" width="1000" height="1000" />
				<FormattedDate className="date" date={pubDate} />
				<h1>{title}</h1>
			</header>
			<div class="text">
				{body}
			</div>
		</article>
	</main>
</Layout>

<style>
	:global(body) {
		padding-block-start: calc(var(--navbar-height) + 2rem);
	}

	.main-header {
		width: 70%;
		margin-inline: auto;

		.back-button a {
			display: flex;
			align-items: center;
			gap: 0.5em;
			width: fit-content;
			padding-inline: 1.2em;
			margin-block-end: 2rem;

			line-height: 2em;
			border: 1px solid oklch(var(--clr-text));
			border-radius: 100vmax;
		}
	}

	main {
		max-width: min(90%, calc(var(--max-main-width) + 10rem));
		margin-inline: auto;
	}

	article {
		.article-header {
			display: flex;
			align-items: center;
			gap: 2rem;

			.image {
				width: 25rem;
				height: 25rem;
				object-fit: cover;
				border-radius: 1rem;
			}
		}

		.text {
		}
	}
</style>
